<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
  />
  <title>MCM Stocks — Home</title>

  <!-- Fonts / Icons -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet" />
  <link href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" />

  <!-- Global styles -->
  <link rel="stylesheet" href="./main.css" />

  <!-- Auth + helpers -->
  <script src="./main.js"></script>

  <style>
    :root {
      --hero-bg: var(--navy, #14213D);
      --hero-fg: var(--white, #ffffff);
      --accent: var(--gold, #FCA311);
      --muted-fg: #8b8b8b;
      --ok: #16c784;
      --bad: #ea3943;
      --card-bg-soft: rgba(255,255,255,0.06);
    }
    .hero {
      background: var(--hero-bg);
      color: var(--hero-fg);
      padding: 48px 0 40px;
    }
    .hero h1 { margin: 0 0 8px; font-size: 32px; line-height: 1.15; }
    .hero p { margin: 0; color: rgba(255,255,255,0.72); }
    .hero-cta { margin-top: 16px; display: flex; gap: 10px; flex-wrap: wrap; }
    .hero .button.ghost {
      background: transparent; border: 1px solid rgba(255,255,255,0.25); color: #fff;
    }
    .strip {
      background: rgba(255,255,255,0.04);
      color: rgba(255,255,255,0.85);
      border-radius: 12px;
      margin-top: 18px;
      padding: 12px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
    }
    .stat { display: flex; flex-direction: column; gap: 2px; }
    .stat .k { font-weight: 700; }
    .stat .v { font-size: 13px; color: rgba(255,255,255,0.7); }

    .section { padding: 28px 0; }
    .market-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
    }
    .ticker-card { cursor: pointer; transition: transform .12s ease; }
    .ticker-card:hover { transform: translateY(-2px); }
    .row { display: flex; justify-content: space-between; align-items: center; }
    .sym { font-weight: 700; }
    .price { font-weight: 700; }
    .chg.ok { color: var(--ok); }
    .chg.bad { color: var(--bad); }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
    }
    .badge { font-size: 12px; font-weight: 700; color: #111; background: var(--accent); padding: 4px 8px; border-radius: 999px; }
    .cta-band {
      background: var(--card-bg-soft);
      border-radius: 14px;
      display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between;
      gap: 12px; padding: 16px;
    }
  </style>
</head>
<body>
  <!-- Header / Nav -->
  <header>
    <div style="font-weight:700">MCM Stocks</div>
    <nav>
      <ul>
        <li><a href="index.html" data-top="index.html">Home</a></li>
        <li><a href="cash.html" data-top="cash.html">Wallet</a></li>
        <li id="nav-market"><a href="market.html" data-top="market.html">Market</a></li>
        <li id="nav-login"><a href="login.html" data-top="login.html">Login</a></li>
        <li id="nav-register"><a href="register.html" data-top="register.html">Register</a></li>
        <li id="nav-logout" style="display:none;"><a href="#" onclick="logoutUser()">Logout</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <div class="content">
        <div class="card" style="background:transparent; box-shadow:none;">
          <div style="display:flex; flex-wrap:wrap; gap:16px; align-items:center; justify-content:space-between;">
            <div style="flex:1; min-width:260px;">
              <span class="badge">Low fees • Fast execution</span>
              <h1>Buy, sell, and manage stocks with confidence</h1>
              <p>Institutional-grade tools with a retail-friendly experience. Your portfolio, your edge.</p>
              <div class="hero-cta">
                <a id="cta-register" href="register.html" class="button positive"><i class="fa fa-user-plus"></i> Create free account</a>
                <a href="market.html" class="button ghost"><i class="fa fa-line-chart"></i> Start trading</a>
              </div>

              <!-- Slim stats strip -->
              <div class="strip">
                <div class="stat"><div class="k">0.00%</div><div class="v">Account opening fee</div></div>
                <div class="stat"><div class="k">Instant</div><div class="v">Portfolio updates</div></div>
                <div class="stat"><div class="k">24/7</div><div class="v">Orders &amp; funding</div></div>
                <div class="stat"><div class="k">Secure</div><div class="v">Encrypted &amp; audited</div></div>
              </div>
            </div>

            <div style="flex:1; min-width:280px;">
              <div class="card" style="background:rgba(255,255,255,0.06); color:#fff;">
                <h3 style="margin-top:0">Market preview</h3>
                <div class="market-grid" id="mk-grid"><!-- filled by script --></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TRUST / BENEFITS -->
    <section class="section">
      <div class="content">
        <div class="features">
          <div class="card">
            <h3><i class="fa fa-lock"></i> Security first</h3>
            <p class="muted">2FA ready, encrypted credentials, and role-based controls.</p>
          </div>
          <div class="card">
            <h3><i class="fa fa-bolt"></i> Lightning execution</h3>
            <p class="muted">Snappy order routing and instant portfolio updates.</p>
          </div>
          <div class="card">
            <h3><i class="fa fa-sliders"></i> Pro tools, simple UI</h3>
            <p class="muted">Watchlists, order types, and analytics without the clutter.</p>
          </div>
          <div class="card">
            <h3><i class="fa fa-life-ring"></i> Human support</h3>
            <p class="muted">Clear docs and responsive help when you need it.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CALL TO ACTION BAND -->
    <section class="section">
      <div class="content">
        <div class="cta-band">
          <div>
            <h2 style="margin:0;">Ready to get started?</h2>
            <p class="muted" style="margin:6px 0 0;">Create an account in minutes and place your first trade today.</p>
          </div>
          <div>
            <a id="cta-footer-register" href="register.html" class="button positive"><i class="fa fa-user-plus"></i> Create account</a>
            <a href="login.html" class="button" style="margin-left:8px;"><i class="fa fa-sign-in"></i> Login</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="content" style="padding-bottom:32px;">
    <p class="muted">© 2025 MCM Stocks</p>
  </footer>

  <!-- Active nav highlight -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const page = location.pathname.split("/").pop() || "index.html";
      document.querySelectorAll('header nav a[data-top]').forEach(a =>
        a.classList.toggle('active', a.getAttribute('data-top') === page)
      );
    });
  </script>

  <!-- Auth-aware nav toggle + CTA hide -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const loggedIn = !!(window.AuthAPI && AuthAPI.isAuthenticated && AuthAPI.isAuthenticated());
      const logoutItem = document.getElementById("nav-logout");
      const loginItem  = document.getElementById("nav-login");
      const regItem    = document.getElementById("nav-register");

      if (loggedIn) {
        if (logoutItem) logoutItem.style.display = "inline-block";
        if (loginItem)  loginItem.style.display  = "none";
        if (regItem)    regItem.style.display    = "none";

        // Hide CTAs when logged in
        const cta1 = document.getElementById("cta-register");
        const cta2 = document.getElementById("cta-footer-register");
        if (cta1) cta1.style.display = "none";
        if (cta2) cta2.style.display = "none";
      } else {
        if (logoutItem) logoutItem.style.display = "none";
        if (loginItem)  loginItem.style.display  = "inline-block";
        if (regItem)    regItem.style.display    = "inline-block";
      }
    });
  </script>

  <!-- Mini market preview (LIVE from API) -->
  <script>
  (async function () {
    const grid = document.getElementById("mk-grid");
    if (!grid) return;

    grid.innerHTML = `
      <div class="card ticker-card"><div class="row"><div><div class="sym">…</div><div class="muted" style="font-size:12px">Loading…</div></div><div style="text-align:right"><div class="price">$—</div><div class="chg">—</div></div></div></div>
      <div class="card ticker-card"><div class="row"><div><div class="sym">…</div><div class="muted" style="font-size:12px">Loading…</div></div><div style="text-align:right"><div class="price">$—</div><div class="chg">—</div></div></div></div>
      <div class="card ticker-card"><div class="row"><div><div class="sym">…</div><div class="muted" style="font-size:12px">Loading…</div></div><div style="text-align:right"><div class="price">$—</div><div class="chg">—</div></div></div></div>
    `;

    try {
      const res = await fetch("/api/market/assets?limit=12");
      const payload = await res.json();
      const stocks = payload?.data || [];

      if (!stocks.length) {
        grid.innerHTML = `<div class="muted">No symbols yet. Add some via Admin → Create Stock.</div>`;
        return;
      }

      grid.innerHTML = stocks.map(s => `
        <div class="card ticker-card" data-symbol="${s.ticker}">
          <div class="row">
            <div>
              <div class="sym">${s.ticker}</div>
              <div class="muted" style="font-size:12px">${s.name}</div>
            </div>
            <div style="text-align:right">
              <div class="price">$${Number(s.initial_price ?? 0).toFixed(2)}</div>
              <div class="chg ok">0.00%</div>
            </div>
          </div>
        </div>
      `).join("");

      grid.querySelectorAll(".ticker-card").forEach(card => {
        card.addEventListener("click", () => {
          const sym = card.getAttribute("data-symbol");
          location.href = `market.html?symbol=${encodeURIComponent(sym)}`;
        });
      });

    } catch (err) {
      grid.innerHTML = `<div class="error">Failed to load market preview: ${err.message}</div>`;
    }
  })();
  </script>
</body>
</html>
